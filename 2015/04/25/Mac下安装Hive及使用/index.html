<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Mac下安装Hive及使用 · Snow Memory | Andrew Liu</title><meta name="description" content="Mac下安装Hive及使用 - Andrew Liu"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://andrewliu.in/atom.xml" title="Snow Memory | Andrew Liu"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/dinosaurliu" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/Andrew-liu" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/about" target="_self" class="nav-list-link">ABOUT</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">Mac下安装Hive及使用</h1><div class="post-info">Apr 25, 2015</div><div class="post-content"><p>本博客采用创作共用版权协议, 要求署名、非商业用途和保持一致. 转载本博客文章必须也遵循<a href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh" target="_blank" rel="external">署名-非商业用途-保持一致</a>的创作共用协议.</p>
<blockquote>
<p>Hive利用MapReduce编程技术, 实现了部分SQL语句, 提供了类SQL的编程接口.</p>
</blockquote>
<h2 id="1-Hive简介"><a href="#1-Hive简介" class="headerlink" title="#1. Hive简介"></a>#1. Hive简介</h2><p>Hive是一个基于<code>Hadoop文件系统HDFS</code>上的数据仓库架构, 它为数据仓库管理提供: 数据ETL(抽取, 转换和加载)工具, 数据仓库管理和大型数据集的查询和分析功能. 定义了类SQL语言<code>Hive QL</code>. 其优势在于极大的可扩展性, 良好的容错性和低约束的数据输入格式</p>
<a id="more"></a>
<h2 id="数据存储"><a href="#数据存储" class="headerlink" title="数据存储"></a>数据存储</h2><p>Hive中每个表都有一个对应的存储目录.<br>Hive有三种模式可以连接到RDBMS中:</p>
<ol>
<li>Single User Mode, 利用此模式连接到一个In-Memory数据库, 一般用于单元测试</li>
<li>Multi User Mode, 通过网络连接到一个数据库中(常用)</li>
<li>Remote Server Mode, 用于非Java客户端访问元数据库, 在服务器端启动MetaStoreServer, 在客户端利用Thrift协议通过MetaStoreServer访问元数据库</li>
</ol>
<h2 id="2-Hive安装"><a href="#2-Hive安装" class="headerlink" title="#2. Hive安装"></a>#2. Hive安装</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ brew install hive</div></pre></td></tr></table></figure>
<p>配置环境变量</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ vim ~/.zshrc</div><div class="line"></div><div class="line">export HADOOP_HOME=&quot;/usr/local/Cellar/hadoop/2.6.0&quot;</div><div class="line">export JAVA_HOME=&quot;$(/usr/libexec/java_home)&quot;</div><div class="line">export HIVE_HOME=&quot;/usr/local/Cellar/hive/1.0.0/libexec&quot;</div></pre></td></tr></table></figure>
<p>在hive安装目录下libexec/conf/中</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ cp hive-env.sh.template hive-env.sh</div><div class="line">$ cp hive-default.xml.template hive-site.xml</div></pre></td></tr></table></figure>
<p>修改hive-env.sh<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">export HADOOP_HEAPSIZE=1024</div><div class="line"></div><div class="line"># Set HADOOP_HOME to point to a specific hadoop install directory</div><div class="line">HADOOP_HOME=/usr/local/Cellar/hadoop/2.6.0</div><div class="line"></div><div class="line"># Hive Configuration Directory can be controlled by:</div><div class="line">export HIVE_CONF_DIR=/usr/local/Cellar/hive/1.0.0/libexec/conf</div><div class="line"></div><div class="line"># Folder containing extra ibraries required for hive compilation/execution can be controlled by:</div><div class="line">export HIVE_AUX_JARS_PATH=/usr/local/Cellar/hive/1.0.0/libexec/lib</div></pre></td></tr></table></figure></p>
<p>修改libexec下conf文件夹中hive-site.xml<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">&lt;property&gt;</div><div class="line">    &lt;name&gt;hive.querylog.location&lt;/name&gt;</div><div class="line">    &lt;value&gt;/usr/local/Cellar/hive/1.0.0/log&lt;/value&gt;</div><div class="line">    &lt;description&gt;Location of Hive run time structured log file&lt;/description&gt;</div><div class="line">&lt;/property&gt;</div><div class="line">&lt;property&gt;</div><div class="line">    &lt;name&gt;hive.exec.scratchdir&lt;/name&gt;</div><div class="line">    &lt;value&gt;/tmp/hive-$&#123;user.name&#125;&lt;/value&gt;</div><div class="line">    &lt;description&gt;HDFS root scratch dir for Hive jobs which gets created with write all (733) permission. For each connecting user, an HDFS scratch dir: $     &#123;hive.exec.scratchdir&#125;/&amp;lt;username&amp;gt; is created, with $&#123;hive.scratch.dir.permission&#125;.&lt;/description&gt;</div><div class="line">&lt;/property&gt;</div><div class="line">  &lt;property&gt;</div><div class="line">    &lt;name&gt;hive.exec.local.scratchdir&lt;/name&gt;</div><div class="line">    &lt;value&gt;/tmp/$&#123;user.name&#125;&lt;/value&gt;</div><div class="line">    &lt;description&gt;Local scratch space for Hive jobs&lt;/description&gt;</div><div class="line">  &lt;/property&gt;</div><div class="line">&lt;property&gt;</div><div class="line">    &lt;name&gt;hive.downloaded.resources.dir&lt;/name&gt;</div><div class="line">    &lt;value&gt;/tmp/$&#123;user.name&#125;_resources&lt;/value&gt;</div><div class="line">    &lt;description&gt;Temporary local directory for added resources in the remote file system.&lt;/description&gt;</div><div class="line">  &lt;/property&gt;</div><div class="line">&lt;property&gt;</div><div class="line">    &lt;name&gt;hive.server2.logging.operation.log.location&lt;/name&gt;</div><div class="line">    &lt;value&gt;/tmp/$&#123;user.name&#125;/operation_logs&lt;/value&gt;</div><div class="line">    &lt;description&gt;Top level directory where operation logs are stored if logging functionality is enabled&lt;/description&gt;</div><div class="line">  &lt;/property&gt;</div></pre></td></tr></table></figure></p>
<p>安装mysql<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">$ brew install mysql</div><div class="line"></div><div class="line">$ mysql.server start  #启动mysql</div><div class="line">$ mysql -uroot  #root用户进入mysql</div><div class="line"></div><div class="line">mysql&gt; CREATE DATABASE metastore;</div><div class="line">mysql&gt; USE metastore;</div><div class="line">mysql&gt; CREATE USER &apos;hive&apos;@&apos;localhost&apos; IDENTIFIED BY &apos;hive&apos;;</div><div class="line">mysql&gt; GRANT SELECT,INSERT,UPDATE,DELETE,ALTER,CREATE ON metastore.* TO &apos;hive&apos;@&apos;localhost&apos;;</div></pre></td></tr></table></figure></p>
<p>启动hadoop服务</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ $HODOOP_HOME/sbin/start-dfs.sh  #启动hdfs</div></pre></td></tr></table></figure>
<p>启动hive</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ /usr/local/Cellar/hive/1.0.0/bin/hive</div><div class="line"></div><div class="line">在~/.zshrc 设置快捷方式</div><div class="line">alias hive=&apos;/usr/local/Cellar/hive/1.0.0/bin/hive&apos;</div></pre></td></tr></table></figure>
<h2 id="3-Hive-Shell命令"><a href="#3-Hive-Shell命令" class="headerlink" title="#3. Hive Shell命令"></a>#3. Hive Shell命令</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">#显示所有的数据表</div><div class="line">hive&gt;show tables; </div><div class="line">#创建一个表,这个表包括两列,分别是整数类型以及字符串 类型,使用文本文件表达,数据域之间的分隔符为\t</div><div class="line">hive&gt; create table shakespeare (freq int, word string) row format delimited fields terminated by ‘\t’ stored as textfile;</div><div class="line">#显示所创建的数据表的描述,即创建时候对于数据表的定义</div><div class="line">hive&gt; describe shakespeare;</div><div class="line">数据装入到Hive中</div><div class="line">hive&gt; load data inpath “shakespeare_freq” into table shakespeare;</div><div class="line">#SELECTS and FILTERS</div><div class="line">hive&gt; select * from shakespeare limit 10;</div><div class="line">hive&gt; SELECT a.foo FROM invites a WHERE a.ds=&apos;2008-08-15&apos;;</div><div class="line">#Group by</div><div class="line">hive&gt; INSERT OVERWRITE TABLE events SELECT a.bar, count(*)</div><div class="line">FROM invites a WHERE a.foo &gt; 0 GROUP BY a.bar;</div><div class="line">#Join</div><div class="line">hive&gt; SELECT t1.bar, t1.foo, t2.foo</div><div class="line">FROM pokes t1 JOIN invites t2 ON t1.bar = t2.bar;</div></pre></td></tr></table></figure>
<h2 id="4-Hive总结"><a href="#4-Hive总结" class="headerlink" title="#4. Hive总结"></a>#4. Hive总结</h2><ul>
<li>Hive提供了一种类似于SQL的查询语言, 使得其能够用于用户的交互查询</li>
<li>与传统的数据库类似, Hive提供了多个数据表之间的联合查询, 能够完成高效的多个数据表之间的查询</li>
<li>通过底层执行引擎的工作, Hive将SQL语言扩展到很大的查询规模</li>
</ul>
<h2 id="5-参考链接"><a href="#5-参考链接" class="headerlink" title="#5. 参考链接"></a>#5. 参考链接</h2><ul>
<li><a href="https://cwiki.apache.org/confluence/display/Hive/GettingStarted" target="_blank" rel="external">GettingStartedHive</a></li>
<li><a href="http://stackoverflow.com/questions/27099898/java-net-urisyntaxexception-when-starting-hive" target="_blank" rel="external">java.net.URISyntaxException when starting HIVE</a></li>
<li><a href="http://stackoverflow.com/questions/20171455/java-net-connectexception-connection-refused-error-when-running-hive" target="_blank" rel="external">java.net.ConnectException: Connection refused error when running Hive</a></li>
<li><a href="http://mvnrepository.com/artifact/mysql/mysql-connector-java/5.1.35" target="_blank" rel="external">MySQL Java Connector 5.1.35</a></li>
<li><a href="https://noobergeek.wordpress.com/2013/11/09/simplest-way-to-install-and-configure-hive-for-mac-osx-lion/" target="_blank" rel="external">Simplest way to install and configure Hive for Mac OSX Lion</a></li>
</ul>
</div></article></div></main><footer><div class="paginator"><a href="/2015/05/03/Hive和Java-API操作HBase实践/" class="prev">PREV</a><a href="/2015/04/19/Mac下安装HBase及详解/" class="next">NEXT</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'snow-memory';
var disqus_identifier = '2015/04/25/Mac下安装Hive及使用/';
var disqus_title = 'Mac下安装Hive及使用';
var disqus_url = 'http://andrewliu.in/2015/04/25/Mac下安装Hive及使用/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//snow-memory.disqus.com/count.js" async></script><div class="copyright"><p>© 2014 - 2017 <a href="http://andrewliu.in">Andrew Liu</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-58158116-2",'auto');ga('send','pageview');</script></body></html>
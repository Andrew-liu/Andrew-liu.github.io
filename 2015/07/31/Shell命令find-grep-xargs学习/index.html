<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Shell命令find grep xargs学习 · Snow Memory | Andrew Liu</title><meta name="description" content="Shell命令find grep xargs学习 - Andrew Liu"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://andrewliu.in/atom.xml" title="Snow Memory | Andrew Liu"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/dinosaurliu" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/Andrew-liu" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/about" target="_self" class="nav-list-link">ABOUT</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">Shell命令find grep xargs学习</h1><div class="post-info">Jul 31, 2015</div><div class="post-content"><p>本博客采用创作共用版权协议, 要求署名、非商业用途和保持一致. 转载本博客文章必须也遵循<a href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh" target="_blank" rel="external">署名-非商业用途-保持一致</a>的创作共用协议.</p>
<blockquote>
<p>这篇博文这两天写好了, 由于最近比较忙, 所以提前发了, 希望Deadline不要延期.</p>
</blockquote>
<p>#find命令</p>
<p>find命令用于在一个目录(及子目录)中搜索文件, 可以指定匹配条件, 如文件名, 文件类型</p>
<blockquote>
<p>在Mac下有强大的Spotlight和Alfred(感觉window下的everything更牛叉), 所以find用的就比较少了</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">find [-H | -L | -P] [-EXdsx] [-f path] path ... [expression]</div></pre></td></tr></table></figure>
<a id="more"></a>
<p>常用形式为:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"># path表示find命令查找的目录路径</div><div class="line">$ find [path] [expression]</div><div class="line"></div><div class="line"># 查找当前路径下的所有git为前缀的文件, 这里*被称为通配符</div><div class="line">find . -name &apos;git*&apos;</div><div class="line"></div><div class="line"># 查找当前路径下所有以.txt和.pdf为后缀的文件</div><div class="line">$ find . \( -name &quot;*.txt&quot; -o -name &quot;*.pdf&quot; \) -print</div><div class="line"></div><div class="line"></div><div class="line"># !表示否则, 查找所有不是以.txt为后缀的文件</div><div class="line">$ find . ! -name &quot;*.txt&quot; -print</div><div class="line"></div><div class="line"># 按类型搜索, 只所有目录(f表示文件 l表示符号链接(软链接) d表示目录)</div><div class="line">$ find . -type d -print </div><div class="line"></div><div class="line"># 按用户搜索  找到所有andrew_liu的用户文件</div><div class="line">$ find . -type f -user andrew_liu -print</div><div class="line"></div><div class="line"># 按照时间搜索 -atime -30m  搜索30分钟内被访问的文件(后面有详细解释)</div><div class="line">$ find . -atime -30m -type f -print</div><div class="line"># -atime +30m  搜索超过30分钟被访问的文件</div><div class="line">$ find . -atime +30m -type f -print</div><div class="line"></div><div class="line"># 找到以.txt为后缀的文件后删除</div><div class="line">$ find . -type f -name &quot;*.txt&quot; -delete</div></pre></td></tr></table></figure>
<p><strong>按时间搜索</strong>(这些元数据都在inode的结构体中有记录)</p>
<ul>
<li>atime 访问时间 (单位有一周w, 一天d, 一小时h, 一分钟m, 一秒s, 以下类似）</li>
<li>mtime 修改时间 （内容被修改）</li>
<li>ctime 变化时间 （元数据或权限变化）</li>
</ul>
<p>#grep命令</p>
<blockquote>
<p>grep命令是强大的<code>文本搜索命令</code></p>
</blockquote>
<ul>
<li>grep全称是<code>globally search a regular expression and print</code>, 表示全局<code>正则表达式</code>匹配并输出, 它的使用权限是<code>所有用户</code></li>
<li>存在很多grep的修改版, 例如agrep表示<code>近似的grep</code>approximate grep用于模糊字符串搜索, fgrep用于<code>固定样式搜索</code>fixed pattern searches, 而egrep用于<code>搜索更复杂的正则表达式</code>语法(摘自wiki)</li>
</ul>
<blockquote>
<p><strong>使用格式</strong>: grep [options] match_patten file</p>
</blockquote>
<p><code>option</code>这里值列举几个常用的选项, 其他可以使用<code>man grep</code>进行查看</p>
<ul>
<li><code>-c</code>:只输出匹配行的次数</li>
<li><code>-l</code>:查询多文件时只输出包含匹配字符的文件名</li>
<li><code>-n</code>:显示匹配行及行号</li>
<li><code>-v</code>:显示不匹配行</li>
<li><code>-i</code>:搜索时忽略大小写</li>
<li><code>-l</code>:只打印包含匹配行的文件名</li>
<li><code>-e</code>:指明一个查找模式(常用多一次匹配多个查找模式)</li>
<li><code>-R</code>:递归的查找多级目录</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"># 匹配test.doc文件中所有存在hello的行</div><div class="line">$ grep &apos;hello&apos; test.doc</div><div class="line"></div><div class="line"># 匹配test.doc文件中所有存在hello的行, 并打印行号</div><div class="line">$ grep -n &apos;hello&apos; test.doc</div><div class="line"></div><div class="line"># 找到所有行不匹配hel或者how, -e匹配多个模式</div><div class="line">$ grep -v -e &apos;hel&apos; -e &apos;how&apos; test.doc</div><div class="line"></div><div class="line"># 在多级目录中对文本递归搜索</div><div class="line">$ grep &quot;class&quot; . -R -n</div><div class="line">#输出结果:</div><div class="line">./test/class.c:1:class</div><div class="line">./test/class.c:2:class yes</div><div class="line">./test/class.c:4:class fuck</div><div class="line">./test.doc:5:class</div><div class="line">./test.pdf:1:class</div><div class="line"></div><div class="line"># 找到所有以.hel开头的行, 并使用管道命令</div><div class="line">$ cat test.doc | grep &apos;^\.hel&apos;</div><div class="line"></div><div class="line"># 找到所有包含hel行的行数(只输出行数, 没有内容)</div><div class="line">cat test.doc | grep -c &apos;hel&apos;</div><div class="line"></div><div class="line"># 更多使用选项使用</div><div class="line">$ man grep</div></pre></td></tr></table></figure>
<p>关于正则表达式的学习可以看<a href="http://andrewliu.tk/2014/10/26/2014-10-26-Python%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/" target="_blank" rel="external">Python正则表达式</a></p>
<h1 id="xargs命令"><a href="#xargs命令" class="headerlink" title="xargs命令"></a>xargs命令</h1><ul>
<li>xargs 能够将输入数据转化为特定命令的命令行参数,可以配合很多命令来组合使用</li>
<li>经常和find, grep通过管道连接使用</li>
</ul>
<p>xargs参数说明</p>
<ul>
<li><code>-d</code> 定义定界符 （默认为空格 多行的定界符为 n）</li>
<li><code>-n</code> 指定输出为多行</li>
<li><code>-I</code> {} 指定替换字符串，这个字符串在xargs扩展时会被替换掉,用于- `待执行的命令需要多个参数时</li>
<li><code>-0</code>：指定0为输入定界符</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"># 将多行输出转化为单行输出</div><div class="line">$ cat test.doc|xargs</div><div class="line"></div><div class="line"># 将单行输出转化为多行输出, -n指定每行显示的单词数, 下面表示将单行转换为每行显示五个单词</div><div class="line">$ cat new.pdf| xargs -n 5</div><div class="line">Here you can select if</div><div class="line">you want to set the</div><div class="line">gesture for Magic Mouse or</div><div class="line">for the Trackpad or for</div><div class="line">the Keyboard</div></pre></td></tr></table></figure>
<h1 id="其他常用小命令"><a href="#其他常用小命令" class="headerlink" title="其他常用小命令"></a>其他常用小命令</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div></pre></td><td class="code"><pre><div class="line"># 清空文件</div><div class="line">$ :&gt; a.txt</div><div class="line"></div><div class="line"># 将文本中的制表符转换为空格</div><div class="line">$ cat text| tr &apos;\t&apos; &apos; &apos;  //制表符转空格</div><div class="line"></div><div class="line"># 统计行数, 常用统计整个项目的代码量</div><div class="line">$ wc -l file </div><div class="line"></div><div class="line"># 打包当前文件夹(不压缩), -c为打包选项, -v为显示打包进度, -f为使用档案文件</div><div class="line">$ tar -cvf test.tar ./</div><div class="line"></div><div class="line"># 解包 -x为解包选项</div><div class="line">$ tar -xvf test.tar</div><div class="line"></div><div class="line"># 压缩文件, 生成文件为.gz后缀</div><div class="line">$ gzip test.tar</div><div class="line"></div><div class="line"># 解压缩文件, 解压为test.tar</div><div class="line">$ gzip test.tar.gz</div><div class="line"></div><div class="line"># 查看端口占用的进程状态</div><div class="line">$ lsof -i:5000</div><div class="line"></div><div class="line"># 端口号被占用:</div><div class="line">$ sudo netstat -tulpn | grep 80</div><div class="line">$ sudo netstat -aWn --programs | grep 80</div><div class="line"></div><div class="line"># 查询被监听的端口</div><div class="line">$ lsof -i tcp | grep LISTEN</div><div class="line"></div><div class="line"># 通过PID进程号杀死进程</div><div class="line">$ sudo kill -s (PID)</div><div class="line"></div><div class="line"># DNS查询，寻找域名domain对应的IP</div><div class="line">$ host andrewliu.tk</div><div class="line">andrewliu.tk has address 103.245.222.133</div><div class="line"></div><div class="line"># SSH登陆:</div><div class="line">$ ssh username@host</div><div class="line"></div><div class="line"># ftp/sftp文件传输(重要)</div><div class="line">$ sftp username@host</div><div class="line"></div><div class="line"># 远程文件复制, scp -r 要复制的整个目录 username@host:目的目录</div><div class="line">$ $scp localpath ID@host:path</div><div class="line">$ scp -r MonitorTrend bin_liu@10.64.24.91:Flask</div><div class="line"></div><div class="line"># 添加新的用户和密码</div><div class="line">$ useradd -m username</div><div class="line">$ passwd username</div><div class="line"></div><div class="line"># 删除用户</div><div class="line">$ userdel -r username</div><div class="line"></div><div class="line"># 不同用户之间切换</div><div class="line">$ su userB</div></pre></td></tr></table></figure>
<h1 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h1><ul>
<li><a href="https://zh.wikipedia.org/zh-cn/Grep" target="_blank" rel="external">grep</a></li>
<li><a href="http://bash.cyberciti.biz/guide/Main_Page" target="_blank" rel="external">Linux Shell Scripting Tutorial (LSST) v2.0</a></li>
<li><a href="http://linuxtools-rst.readthedocs.org/zh_CN/latest/base/01_use_man.html" target="_blank" rel="external">Linux Tools Quick Tutorial</a></li>
<li><a href="http://linuxtools-rst.readthedocs.org/zh_CN/latest/tool/sar.html#sar" target="_blank" rel="external">sar 找出系统瓶颈的利器</a></li>
</ul>
</div></article></div></main><footer><div class="paginator"><a href="/2015/08/10/理解硬链接和软链接/" class="prev">上一篇</a><a href="/2015/07/26/设计模式之装饰者模式与工厂模式/" class="next">下一篇</a></div><div class="copyright"><p>© 2014 - 2017 <a href="http://andrewliu.in">Andrew Liu</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-58158116-2",'auto');ga('send','pageview');</script></body></html>